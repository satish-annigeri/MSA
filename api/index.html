<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>API Reference - MSA</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../assets/_mkdocstrings.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "API Reference";
        var mkdocs_page_input_path = "api.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/python.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> MSA
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../installation/">Installation</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../usermanual/">User Manual</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="#">API Reference</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#plane-frame-package">Plane Frame Package</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#msa.pf">pf</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#msa.pf.pf_assem_loadvec_jl">pf_assem_loadvec_jl</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#msa.pf.pf_assem_loadvec_ml">pf_assem_loadvec_ml</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#msa.pf.pf_assemssm">pf_assemssm</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#msa.pf.pf_calclen">pf_calclen</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#msa.pf.pf_calclm">pf_calclm</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#msa.pf.pf_calcrot">pf_calcrot</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#msa.pf.pf_get_dof">pf_get_dof</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#msa.pf.pf_get_endcoord">pf_get_endcoord</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#msa.pf.pf_get_endjts">pf_get_endjts</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#msa.pf.pf_get_memprop">pf_get_memprop</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#msa.pf.pf_gstiff">pf_gstiff</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#msa.pf.pf_loadvec">pf_loadvec</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#msa.pf.pf_mem_endforces">pf_mem_endforces</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#msa.pf.pf_ssm">pf_ssm</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#msa.pf.pf_stiff">pf_stiff</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#msa.pf.print_mat">print_mat</a>
    </li>
    </ul>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">MSA</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">API Reference</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="api-reference">API Reference<a class="headerlink" href="#api-reference" title="Permanent link">&para;</a></h1>
<h2 id="plane-frame-package">Plane Frame Package<a class="headerlink" href="#plane-frame-package" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="msa.pf"></a>
    <div class="doc doc-contents first">

        <p>Python package for analysis of skeletal structures using the direct stiffness method. The code is based
on the theory and flowcharts in Weaver, W. and Gere, J.M., <em>Matrix Analysis of Framed Structures</em>,
CBS Publishers, New Delhi, 1986. The package <code>pf</code> implements the analysis of plane frames.</p>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="msa.pf.pf_assem_loadvec_jl" class="doc doc-heading">
            <code class="highlight language-python">pf_assem_loadvec_jl(lm, df_jtloads, P)</code>

<a href="#msa.pf.pf_assem_loadvec_jl" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Superpose joint loads on structure load vector</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>lm</code></b>
                  (<code><span title="msa.pf.NDArrayInt">NDArrayInt</span></code>)
              –
              <div class="doc-md-description">
                <p>Location matrix, specifying degree of freedom number for each node</p>
              </div>
            </li>
            <li>
              <b><code>df_jtloads</code></b>
                  (<code><span title="pandas.DataFrame">DataFrame</span></code>)
              –
              <div class="doc-md-description">
                <p>Nodal loads table</p>
              </div>
            </li>
            <li>
              <b><code>P</code></b>
                  (<code><span title="msa.pf.NDArrayFloat">NDArrayFloat</span></code>)
              –
              <div class="doc-md-description">
                <p>Load vector</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="msa.pf.NDArrayFloat">NDArrayFloat</span></code>
              –
              <div class="doc-md-description">
                <p>Modified load vector after superposing all nodal loads</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>msa/pf.py</code></summary>
              <pre class="highlight"><code class="language-python">def pf_assem_loadvec_jl(lm, df_jtloads, P):
    """Superpose joint loads on structure load vector

    Parameters
    ----------
    lm : NDArrayInt
        Location matrix, specifying degree of freedom number for each node
    df_jtloads : pd.DataFrame
        Nodal loads table
    P : NDArrayFloat
        Load vector

    Returns
    -------
    NDArrayFloat
        Modified load vector after superposing all nodal loads
    """
    nloads = len(df_jtloads)
    for iload in range(nloads):
        jt = int(df_jtloads.iloc[iload, 0])
        jtdof = lm[jt - 1, :]
        for j in range(3):
            if jtdof[j]:
                i = jtdof[j] - 1
                P[i] += df_jtloads.iloc[iload, j + 1]
    return P</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="msa.pf.pf_assem_loadvec_ml" class="doc doc-heading">
            <code class="highlight language-python">pf_assem_loadvec_ml(iload, df_xy, df_conn, lm, df_memloads, P)</code>

<a href="#msa.pf.pf_assem_loadvec_ml" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Superpose equivalent joint loads due to loads applied on members onto
structure load vector</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>iload</code></b>
                  (<code><span title="int">int</span></code>)
              –
              <div class="doc-md-description">
                <p>Number of member load</p>
              </div>
            </li>
            <li>
              <b><code>df_xy</code></b>
                  (<code><span title="pandas.DataFrame">DataFrame</span></code>)
              –
              <div class="doc-md-description">
                <p>Coordinates of nodes</p>
              </div>
            </li>
            <li>
              <b><code>df_conn</code></b>
                  (<code><span title="pandas.DataFrame">DataFrame</span></code>)
              –
              <div class="doc-md-description">
                <p>Connectivity of members</p>
              </div>
            </li>
            <li>
              <b><code>lm</code></b>
                  (<code><span title="msa.pf.NDArrayInt">NDArrayInt</span></code>)
              –
              <div class="doc-md-description">
                <p>Location matrix, specifying degree of freedom number for each node</p>
              </div>
            </li>
            <li>
              <b><code>df_memloads</code></b>
                  (<code><span title="pandas.DataFrame">DataFrame</span></code>)
              –
              <div class="doc-md-description">
                <p>Member load table</p>
              </div>
            </li>
            <li>
              <b><code>P</code></b>
                  (<code>Load vector</code>)
              –
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="msa.pf.NDArrayFloat">NDArrayFloat</span></code>
              –
              <div class="doc-md-description">
                <p>Modified load vector after superposing member load number <code>iload</code></p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>msa/pf.py</code></summary>
              <pre class="highlight"><code class="language-python">def pf_assem_loadvec_ml(iload, df_xy, df_conn, lm, df_memloads, P):
    """Superpose equivalent joint loads due to loads applied on members onto
    structure load vector

    Parameters
    ----------
    iload : int
        Number of member load
    df_xy : pd.DataFrame
        Coordinates of nodes
    df_conn : pd.DataFrame
        Connectivity of members
    lm : NDArrayInt
        Location matrix, specifying degree of freedom number for each node
    df_memloads : pd.DataFrame
        Member load table
    P : Load vector
        _description_

    Returns
    -------
    NDArrayFloat
        Modified load vector after superposing member load number `iload`
    """
    imem = int(df_memloads.iloc[iload - 1, 0])
    xy1, xy2 = pf_get_endcoord(imem, df_xy, df_conn)
    L, dc = pf_calclen(xy1, xy2)
    r = pf_calcrot(dc)
    ml = df_memloads.iloc[iload - 1, 1:7]
    # ml = ml.reshape(len(ml), 1)
    # ml = ml.values
    # am = np.dot(-r.T, ml)
    am = -r.T @ ml
    memdof = pf_get_dof(imem, df_conn, lm)
    for i in range(6):
        if memdof[i]:
            ii = memdof[i] - 1
            P[ii] += am[i]
    return P</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="msa.pf.pf_assemssm" class="doc doc-heading">
            <code class="highlight language-python">pf_assemssm(imem, df_xy, df_conn, df_mprop, lm, ssm)</code>

<a href="#msa.pf.pf_assemssm" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Superpose stiffness matrix of plane frame member on the structure
stiffness matrix</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>imem</code></b>
                  (<code><span title="int">int</span></code>)
              –
              <div class="doc-md-description">
                <p>Number of the member</p>
              </div>
            </li>
            <li>
              <b><code>df_xy</code></b>
                  (<code><span title="pandas.DataFrame">DataFrame</span></code>)
              –
              <div class="doc-md-description">
                <p>Coordinates of nodes</p>
              </div>
            </li>
            <li>
              <b><code>df_conn</code></b>
                  (<code><span title="pandas.DataFrame">DataFrame</span></code>)
              –
              <div class="doc-md-description">
                <p>Connectivity of members</p>
              </div>
            </li>
            <li>
              <b><code>df_mprop</code></b>
                  (<code><span title="pandas.DataFrame">DataFrame</span></code>)
              –
              <div class="doc-md-description">
                <p>Material properties table</p>
              </div>
            </li>
            <li>
              <b><code>lm</code></b>
                  (<code><span title="msa.pf.NDArrayFloat">NDArrayFloat</span></code>)
              –
              <div class="doc-md-description">
                <p>Location matrix, specifying degree of freedom number for each node</p>
              </div>
            </li>
            <li>
              <b><code>ssm</code></b>
                  (<code><span title="msa.pf.NDArrayFloat">NDArrayFloat</span></code>)
              –
              <div class="doc-md-description">
                <p>Structure stiffness matrix, initially a zero matrix</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="msa.pf.NDArrayFloat">NDArrayFloat</span></code>
              –
              <div class="doc-md-description">
                <p>Structure stiffness matrix, after superposition of global stiffness of all members</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>msa/pf.py</code></summary>
              <pre class="highlight"><code class="language-python">def pf_assemssm(imem, df_xy, df_conn, df_mprop, lm, ssm):
    """Superpose stiffness matrix of plane frame member on the structure
    stiffness matrix

    Parameters
    ----------
    imem : int
        Number of the member
    df_xy : pd.DataFrame
        Coordinates of nodes
    df_conn : pd.DataFrame
        Connectivity of members
    df_mprop : pd.DataFrame
        Material properties table
    lm : NDArrayFloat
        Location matrix, specifying degree of freedom number for each node
    ssm : NDArrayFloat
        Structure stiffness matrix, initially a zero matrix

    Returns
    -------
    NDArrayFloat
        Structure stiffness matrix, after superposition of global stiffness of all members
    """
    K = pf_gstiff(imem, df_xy, df_conn, df_mprop)
    memdof = pf_get_dof(imem, df_conn, lm)
    for i in range(len(memdof)):
        if memdof[i]:
            for j in range(len(memdof)):
                if memdof[j]:
                    ii = memdof[i] - 1
                    jj = memdof[j] - 1
                    ssm[ii, jj] += K[i, j]
    return ssm</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="msa.pf.pf_calclen" class="doc doc-heading">
            <code class="highlight language-python">pf_calclen(xy1, xy2)</code>

<a href="#msa.pf.pf_calclen" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Calculate length and direction cosines of a plane frame member</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>xy1</code></b>
                  (<code>NDArrayFloat shape (2,)</code>)
              –
              <div class="doc-md-description">
                <p>(x, y) coordinates of node 1</p>
              </div>
            </li>
            <li>
              <b><code>xy2</code></b>
                  (<code>NDArrayFloat shape (2,)</code>)
              –
              <div class="doc-md-description">
                <p>(x, y) coordinates of node 2</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="float">float</span></code>
              –
              <div class="doc-md-description">
                <p>Length of the member</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>msa/pf.py</code></summary>
              <pre class="highlight"><code class="language-python">def pf_calclen(xy1, xy2):
    """Calculate length and direction cosines of a plane frame member

    Parameters
    ----------
    xy1 : NDArrayFloat shape (2,)
        (x, y) coordinates of node 1
    xy2 : NDArrayFloat shape (2,)
        (x, y) coordinates of node 2

    Returns
    -------
    float
        Length of the member
    """
    delta = xy2 - xy1
    L = np.sqrt(np.sum(delta**2))
    dc = delta / L
    return L, dc</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="msa.pf.pf_calclm" class="doc doc-heading">
            <code class="highlight language-python">pf_calclm(n, df_bc)</code>

<a href="#msa.pf.pf_calclm" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Calculate location matrix containing degree of freedom numbers of each node</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>n</code></b>
                  (<code><span title="int">int</span></code>)
              –
              <div class="doc-md-description">
                <p>Number of nodes in the structure</p>
              </div>
            </li>
            <li>
              <b><code>df_bc</code></b>
                  (<code><span title="pandas.DataFrame">DataFrame</span></code>)
              –
              <div class="doc-md-description">
                <p>Boundary condition for each degree of freedom of each node. 1 is restrained and 0 is unrestrained.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>lm</code></b>(                  <code><span title="msa.pf.NDArrayInt">NDArrayInt</span></code>
)              –
              <div class="doc-md-description">
                <p>Integer array with degree of freedom number of each nodal displacement</p>
              </div>
            </li>
            <li>
<b><code>nd</code></b>(                  <code><span title="int">int</span></code>
)              –
              <div class="doc-md-description">
                <p>Number of degrees of freedom of the structure</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>msa/pf.py</code></summary>
              <pre class="highlight"><code class="language-python">def pf_calclm(n, df_bc: pd.DataFrame):
    """Calculate location matrix containing degree of freedom numbers of each node

    Parameters
    ----------
    n : int
        Number of nodes in the structure
    df_bc : pd.DataFrame
        Boundary condition for each degree of freedom of each node. 1 is restrained and 0 is unrestrained.

    Returns
    -------
    lm : NDArrayInt
         Integer array with degree of freedom number of each nodal displacement
    nd : int
         Number of degrees of freedom of the structure
    """
    lm = np.zeros((n, 3), dtype=np.int_)
    nd = 0
    ns = len(df_bc)
    for i in range(ns):
        node = int(df_bc.iloc[i, 0])  # type: ignore
        lm[node - 1, 0:3] = df_bc.iloc[i, 1:4]

    for node in range(n):
        for j in range(3):
            if lm[node, j] == 0:
                nd += 1
                lm[node, j] = nd
            else:
                lm[node, j] = 0
    return lm, nd</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="msa.pf.pf_calcrot" class="doc doc-heading">
            <code class="highlight language-python">pf_calcrot(dc)</code>

<a href="#msa.pf.pf_calcrot" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Calculate rotation matrix of a plane frame member given its direction cosines</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>dc</code></b>
                  (<code>NDArrayFloat shape (2,)</code>)
              –
              <div class="doc-md-description">
                <p>Direction cosines of the member with reference to x-y axes</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code>NDArrayFloat shape (6, 6)</code>
              –
              <div class="doc-md-description">
                <p>Rotation matrix to transform local stiffness matrix to global stiffness matrix</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>msa/pf.py</code></summary>
              <pre class="highlight"><code class="language-python">def pf_calcrot(dc):
    """Calculate rotation matrix of a plane frame member given its direction cosines

    Parameters
    ----------
    dc : NDArrayFloat shape (2,)
        Direction cosines of the member with reference to x-y axes

    Returns
    -------
    NDArrayFloat shape (6, 6)
        Rotation matrix to transform local stiffness matrix to global stiffness matrix
    """
    r = np.zeros((6, 6), dtype=float)
    cx = dc[0]
    cy = dc[1]
    r[0, 0] = cx
    r[0, 1] = cy
    r[1, 0] = -cy
    r[1, 1] = cx
    r[2, 2] = 1
    r[3:6, 3:6] = r[0:3, 0:3]
    return r</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="msa.pf.pf_get_dof" class="doc doc-heading">
            <code class="highlight language-python">pf_get_dof(imem, df_conn, lm)</code>

<a href="#msa.pf.pf_get_dof" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Return degree of freedom numbers of the ends of a plane frame member</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>imem</code></b>
                  (<code><span title="int">int</span></code>)
              –
              <div class="doc-md-description">
                <p>Number of the member</p>
              </div>
            </li>
            <li>
              <b><code>df_conn</code></b>
                  (<code><span title="pandas.DataFrame">DataFrame</span></code>)
              –
              <div class="doc-md-description">
                <p>Connectivity of members</p>
              </div>
            </li>
            <li>
              <b><code>lm</code></b>
                  (<code><span title="msa.pf.NDArrayFloat">NDArrayFloat</span></code>)
              –
              <div class="doc-md-description">
                <p>Location matrix, specifying degree of freedom number for each node</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="msa.pf.NDArrayInt">NDArrayInt</span></code>
              –
              <div class="doc-md-description">
                <p>Degree of freedom numbers for node1 and node2</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>msa/pf.py</code></summary>
              <pre class="highlight"><code class="language-python">def pf_get_dof(imem, df_conn, lm):
    """Return degree of freedom numbers of the ends of a plane frame member

    Parameters
    ----------
    imem : int
        Number of the member
    df_conn : pd.DataFrame
        Connectivity of members
    lm : NDArrayFloat
        Location matrix, specifying degree of freedom number for each node

    Returns
    -------
    NDArrayInt
        Degree of freedom numbers for node1 and node2
    """
    jt1, jt2 = pf_get_endjts(imem, df_conn)
    memdof = np.array([0, 0, 0, 0, 0, 0])
    memdof[0:3] = lm[jt1 - 1, :]
    memdof[3:6] = lm[jt2 - 1, :]
    return memdof</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="msa.pf.pf_get_endcoord" class="doc doc-heading">
            <code class="highlight language-python">pf_get_endcoord(imem, df_xy, df_conn)</code>

<a href="#msa.pf.pf_get_endcoord" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Return the coordinates of the first and second end of a plane frame member</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>imem</code></b>
                  (<code><span title="int">int</span></code>)
              –
              <div class="doc-md-description">
                <p>Number of the member</p>
              </div>
            </li>
            <li>
              <b><code>df_xy</code></b>
                  (<code><span title="pandas.DataFrame">DataFrame</span></code>)
              –
              <div class="doc-md-description">
                <p>Coordinates of nodes</p>
              </div>
            </li>
            <li>
              <b><code>df_conn</code></b>
                  (<code><span title="pandas.DataFrame">DataFrame</span></code>)
              –
              <div class="doc-md-description">
                <p>Connectivity of members</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>xy1</code></b>(                  <code><span title="Float">Float</span></code>
)              –
              <div class="doc-md-description">
                <p>Coordinate of node1</p>
              </div>
            </li>
            <li>
<b><code>xy2</code></b>(                  <code><span title="Float">Float</span></code>
)              –
              <div class="doc-md-description">
                <p>Coordinate of node2</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>msa/pf.py</code></summary>
              <pre class="highlight"><code class="language-python">def pf_get_endcoord(imem, df_xy, df_conn):
    """Return the coordinates of the first and second end of a plane frame member

    Parameters
    ----------
    imem : int
        Number of the member
    df_xy : pd.DataFrame
        Coordinates of nodes
    df_conn : pd.DataFrame
        Connectivity of members

    Returns
    -------
    xy1 : Float
        Coordinate of node1
    xy2 : Float
        Coordinate of node2
    """
    jt1, jt2 = pf_get_endjts(imem, df_conn)
    xy1 = df_xy.iloc[int(jt1) - 1, :]  # type: ignore
    xy2 = df_xy.iloc[int(jt2) - 1, :]  # type: ignore
    return xy1, xy2</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="msa.pf.pf_get_endjts" class="doc doc-heading">
            <code class="highlight language-python">pf_get_endjts(imem, df_conn)</code>

<a href="#msa.pf.pf_get_endjts" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Return numbers of first and second end of a plane frame member</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>imem</code></b>
                  (<code><span title="int">int</span></code>)
              –
              <div class="doc-md-description">
                <p>Number of member</p>
              </div>
            </li>
            <li>
              <b><code>df_conn</code></b>
                  (<code><span title="pandas.DataFrame">DataFrame</span></code>)
              –
              <div class="doc-md-description">
                <p>Connectivity matrix</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>jt1</code></b>(                  <code><span title="int">int</span></code>
)              –
              <div class="doc-md-description">
                <p>Node1</p>
              </div>
            </li>
            <li>
<b><code>jt2</code></b>(                  <code><span title="int">int</span></code>
)              –
              <div class="doc-md-description">
                <p>Node 2</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>msa/pf.py</code></summary>
              <pre class="highlight"><code class="language-python">def pf_get_endjts(imem, df_conn: pd.DataFrame):
    """Return numbers of first and second end of a plane frame member

    Parameters
    ----------
    imem : int
        Number of member
    df_conn : pd.DataFrame
        Connectivity matrix

    Returns
    -------
    jt1 : int
        Node1
    jt2 : int
        Node 2
    """
    jt1, jt2 = df_conn.iloc[imem - 1, 0:2]
    return jt1, jt2</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="msa.pf.pf_get_memprop" class="doc doc-heading">
            <code class="highlight language-python">pf_get_memprop(imem, df_xy, df_conn, df_mprop)</code>

<a href="#msa.pf.pf_get_memprop" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Return the material properties of specified plane frame member</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>imem</code></b>
                  (<code><span title="int">int</span></code>)
              –
              <div class="doc-md-description">
                <p>Number of the member</p>
              </div>
            </li>
            <li>
              <b><code>df_xy</code></b>
                  (<code><span title="pandas.DataFrame">DataFrame</span></code>)
              –
              <div class="doc-md-description">
                <p>Coordinates of nodes</p>
              </div>
            </li>
            <li>
              <b><code>df_conn</code></b>
                  (<code><span title="pandas.DataFrame">DataFrame</span></code>)
              –
              <div class="doc-md-description">
                <p>Connectivity of members</p>
              </div>
            </li>
            <li>
              <b><code>df_mprop</code></b>
                  (<code><span title="pandas.DataFrame">DataFrame</span></code>)
              –
              <div class="doc-md-description">
                <p>Material properties table</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>E</code></b>(                  <code><span title="float">float</span></code>
)              –
              <div class="doc-md-description">
                <p>Modulus of elasticity of the member</p>
              </div>
            </li>
            <li>
<b><code>A</code></b>(                  <code><span title="float">float</span></code>
)              –
              <div class="doc-md-description">
                <p>Cross-section area of member</p>
              </div>
            </li>
            <li>
<b><code>Iz</code></b>(                  <code><span title="float">float</span></code>
)              –
              <div class="doc-md-description">
                <p>Second moment of area of cross-section of the member about the axis of bending</p>
              </div>
            </li>
            <li>
<b><code>L</code></b>(                  <code><span title="float">float</span></code>
)              –
              <div class="doc-md-description">
                <p>Length of the member</p>
              </div>
            </li>
            <li>
<b><code>dc</code></b>(                  <code><span title="msa.pf.NDArrayFloat">NDArrayFloat</span></code>
)              –
              <div class="doc-md-description">
                <p>Direction cosines of the member</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>msa/pf.py</code></summary>
              <pre class="highlight"><code class="language-python">def pf_get_memprop(imem, df_xy, df_conn, df_mprop):
    """Return the material properties of specified plane frame member

    Parameters
    ----------
    imem : int
        Number of the member
    df_xy : pd.DataFrame
        Coordinates of nodes
    df_conn : pd.DataFrame
        Connectivity of members
    df_mprop : pd.DataFrame
        Material properties table

    Returns
    -------
    E : float
        Modulus of elasticity of the member
    A : float
        Cross-section area of member
    Iz : float
        Second moment of area of cross-section of the member about the axis of bending
    L : float
        Length of the member
    dc : NDArrayFloat
        Direction cosines of the member
    """
    m = df_conn.iloc[imem - 1, 2] - 1
    E = df_mprop.iloc[m, 0]
    A = df_mprop.iloc[m, 1]
    Iz = df_mprop.iloc[m, 2]
    xy1, xy2 = pf_get_endcoord(imem, df_xy, df_conn)
    L, dc = pf_calclen(xy1, xy2)
    return E, A, Iz, L, dc</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="msa.pf.pf_gstiff" class="doc doc-heading">
            <code class="highlight language-python">pf_gstiff(imem, df_xy, df_conn, df_mprop)</code>

<a href="#msa.pf.pf_gstiff" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Calculate the stiffness matrix of a plane frame member in strucutre
coordinate system</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>imem</code></b>
                  (<code><span title="int">int</span></code>)
              –
              <div class="doc-md-description">
                <p>Number of the member</p>
              </div>
            </li>
            <li>
              <b><code>df_xy</code></b>
                  (<code><span title="pandas.DataFrame">DataFrame</span></code>)
              –
              <div class="doc-md-description">
                <p>Coordinates of nodes</p>
              </div>
            </li>
            <li>
              <b><code>df_conn</code></b>
                  (<code><span title="pandas.DataFrame">DataFrame</span></code>)
              –
              <div class="doc-md-description">
                <p>Connectivity of members</p>
              </div>
            </li>
            <li>
              <b><code>df_mprop</code></b>
                  (<code><span title="pandas.DataFrame">DataFrame</span></code>)
              –
              <div class="doc-md-description">
                <p>Material properties table</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="NDArray">NDArray</span></code>
              –
              <div class="doc-md-description">
                <p>Global stiffness matrix of the member</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>msa/pf.py</code></summary>
              <pre class="highlight"><code class="language-python">def pf_gstiff(imem, df_xy, df_conn, df_mprop):
    """Calculate the stiffness matrix of a plane frame member in strucutre
    coordinate system

    Parameters
    ----------
    imem : int
        Number of the member
    df_xy : pd.DataFrame
        Coordinates of nodes
    df_conn : pd.DataFrame
        Connectivity of members
    df_mprop : pd.DataFrame
        Material properties table

    Returns
    -------
    NDArray
        Global stiffness matrix of the member
    """
    E, A, Iz, L, dc = pf_get_memprop(imem, df_xy, df_conn, df_mprop)
    r = pf_calcrot(dc)
    k = pf_stiff(E, A, Iz, L)
    return r.T @ k @ r</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="msa.pf.pf_loadvec" class="doc doc-heading">
            <code class="highlight language-python">pf_loadvec(df_xy, df_conn, df_jtloads, df_memloads, ndof, lm)</code>

<a href="#msa.pf.pf_loadvec" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Assemble structure load vector due to joint loads and loads applied
directly on members</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>df_xy</code></b>
                  (<code><span title="pandas.DataFrame">DataFrame</span></code>)
              –
              <div class="doc-md-description">
                <p>Coordinates of nodes</p>
              </div>
            </li>
            <li>
              <b><code>df_conn</code></b>
                  (<code><span title="pandas.DataFrame">DataFrame</span></code>)
              –
              <div class="doc-md-description">
                <p>Connectivity of members</p>
              </div>
            </li>
            <li>
              <b><code>df_jtloads</code></b>
                  (<code><span title="pandas.DataFrame">DataFrame</span></code>)
              –
              <div class="doc-md-description">
                <p>Nodal loads table</p>
              </div>
            </li>
            <li>
              <b><code>df_memloads</code></b>
                  (<code><span title="pandas.DataFrame">DataFrame</span></code>)
              –
              <div class="doc-md-description">
                <p>Member load table</p>
              </div>
            </li>
            <li>
              <b><code>ndof</code></b>
                  (<code><span title="int">int</span></code>)
              –
              <div class="doc-md-description">
                <p>Number of degrees of freedom of the structure</p>
              </div>
            </li>
            <li>
              <b><code>lm</code></b>
                  (<code><span title="msa.pf.NDArrayInt">NDArrayInt</span></code>)
              –
              <div class="doc-md-description">
                <p>Location matrix, specifying degree of freedom number for each node</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="msa.pf.NDArrayFloat">NDArrayFloat</span></code>
              –
              <div class="doc-md-description">
                <p>Modified load vector after superposing all member loads</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>msa/pf.py</code></summary>
              <pre class="highlight"><code class="language-python">def pf_loadvec(df_xy, df_conn, df_jtloads, df_memloads, ndof, lm):
    """Assemble structure load vector due to joint loads and loads applied
    directly on members

    Parameters
    ----------
    df_xy : pd.DataFrame
        Coordinates of nodes
    df_conn : pd.DataFrame
        Connectivity of members
    df_jtloads : pd.DataFrame
        Nodal loads table
    df_memloads : pd.DataFrame
        Member load table
    ndof : int
        Number of degrees of freedom of the structure
    lm : NDArrayInt
        Location matrix, specifying degree of freedom number for each node

    Returns
    -------
    NDArrayFloat
        Modified load vector after superposing all member loads
    """
    P = np.zeros((ndof, 1), dtype=float)
    P = pf_assem_loadvec_jl(lm, df_jtloads, P)
    nml = len(df_memloads)
    for iload in range(1, nml + 1):
        P = pf_assem_loadvec_ml(iload, df_xy, df_conn, lm, df_memloads, P)
    return P</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="msa.pf.pf_mem_endforces" class="doc doc-heading">
            <code class="highlight language-python">pf_mem_endforces(imem, df_xy, df_conn, df_mprop, df_memloads, lm, x)</code>

<a href="#msa.pf.pf_mem_endforces" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Calculate member end forces from joint displacements, for one chosen member</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>imem</code></b>
                  (<code><span title="int">int</span></code>)
              –
              <div class="doc-md-description">
                <p>Number of the member</p>
              </div>
            </li>
            <li>
              <b><code>df_xy</code></b>
                  (<code><span title="pandas.DataFrame">DataFrame</span></code>)
              –
              <div class="doc-md-description">
                <p>Coordinates of nodes</p>
              </div>
            </li>
            <li>
              <b><code>df_conn</code></b>
                  (<code><span title="pandas.DataFrame">DataFrame</span></code>)
              –
              <div class="doc-md-description">
                <p>Connectivity of members</p>
              </div>
            </li>
            <li>
              <b><code>df_mprop</code></b>
                  (<code><span title="pandas.DataFrame">DataFrame</span></code>)
              –
              <div class="doc-md-description">
                <p>Material properties table</p>
              </div>
            </li>
            <li>
              <b><code>df_memloads</code></b>
                  (<code><span title="pandas.DataFrame">DataFrame</span></code>)
              –
              <div class="doc-md-description">
                <p>Member load table</p>
              </div>
            </li>
            <li>
              <b><code>lm</code></b>
                  (<code><span title="msa.pf.NDArrayInt">NDArrayInt</span></code>)
              –
              <div class="doc-md-description">
                <p>Location matrix, specifying degree of freedom number for each node</p>
              </div>
            </li>
            <li>
              <b><code>x</code></b>
                  (<code><span title="msa.pf.NDArrayFloat">NDArrayFloat</span></code>)
              –
              <div class="doc-md-description">
                <p>Displacement vector</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="msa.pf.NDArrayFloat">NDArrayFloat</span></code>
              –
              <div class="doc-md-description">
                <p>Vector of member end forces</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>msa/pf.py</code></summary>
              <pre class="highlight"><code class="language-python">def pf_mem_endforces(imem, df_xy, df_conn, df_mprop, df_memloads, lm, x):
    """Calculate member end forces from joint displacements, for one chosen member

    Parameters
    ----------
    imem : int
        Number of the member
    df_xy : pd.DataFrame
        Coordinates of nodes
    df_conn : pd.DataFrame
        Connectivity of members
    df_mprop : pd.DataFrame
        Material properties table
    df_memloads : pd.DataFrame
        Member load table
    lm : NDArrayInt
        Location matrix, specifying degree of freedom number for each node
    x : NDArrayFloat
        Displacement vector

    Returns
    -------
    NDArrayFloat
        Vector of member end forces
    """
    xy1, xy2 = pf_get_endcoord(imem, df_xy, df_conn)
    L, dc = pf_calclen(xy1, xy2)
    E, A, Iz, L, dc = pf_get_memprop(imem, df_xy, df_conn, df_mprop)
    r = pf_calcrot(dc)
    u = np.zeros((6, 1), dtype=float)
    memdof = pf_get_dof(imem, df_conn, lm)
    for i in range(6):
        if memdof[i]:
            idof = memdof[i]
            u[i] = x[idof - 1]
    # uu = np.dot(r, u)
    uu = r @ u
    k = pf_stiff(E, A, Iz, L)
    f = np.zeros((6, 1), dtype=float)
    f = k @ uu
    # f = np.dot(k, uu)

    nml = len(df_memloads)
    for i in range(nml):
        if df_memloads.iloc[i, 0] == imem:
            f += df_memloads.iloc[i, 1:].values.reshape(6, 1)
    return f</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="msa.pf.pf_ssm" class="doc doc-heading">
            <code class="highlight language-python">pf_ssm(df_xy, df_conn, df_bc, df_mprop)</code>

<a href="#msa.pf.pf_ssm" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Assemble structure stiffness matrix by superposing stiffness matrices of
individual members</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>df_xy</code></b>
                  (<code><span title="pandas.DataFrame">DataFrame</span></code>)
              –
              <div class="doc-md-description">
                <p>Coordinates of nodes</p>
              </div>
            </li>
            <li>
              <b><code>df_conn</code></b>
                  (<code><span title="pandas.DataFrame">DataFrame</span></code>)
              –
              <div class="doc-md-description">
                <p>Connectivity of members</p>
              </div>
            </li>
            <li>
              <b><code>df_bc</code></b>
                  (<code><span title="pandas.DataFrame">DataFrame</span></code>)
              –
              <div class="doc-md-description">
                <p>Zero boundary conditions table, for nodes with one or more constrained degrees of freedom</p>
              </div>
            </li>
            <li>
              <b><code>df_mprop</code></b>
                  (<code><span title="pandas.DataFrame">DataFrame</span></code>)
              –
              <div class="doc-md-description">
                <p>Material properties table</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>ssm</code></b>(                  <code><span title="msa.pf.NDArrayFloat">NDArrayFloat</span></code>
)              –
              <div class="doc-md-description">
                <p>Structure stiffness matrix of the structure</p>
              </div>
            </li>
            <li>
<b><code>lm</code></b>(                  <code><span title="msa.pf.NDArrayInt">NDArrayInt</span></code>
)              –
              <div class="doc-md-description">
                <p>Location matrix, specifying degree of freedom number for each node</p>
              </div>
            </li>
            <li>
<b><code>ndof</code></b>(                  <code><span title="int">int</span></code>
)              –
              <div class="doc-md-description">
                <p>Number of degrees of freedom of the structure</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>msa/pf.py</code></summary>
              <pre class="highlight"><code class="language-python">def pf_ssm(df_xy, df_conn, df_bc, df_mprop):
    """Assemble structure stiffness matrix by superposing stiffness matrices of
    individual members

    Parameters
    ----------
    df_xy : pd.DataFrame
        Coordinates of nodes
    df_conn : pd.DataFrame
        Connectivity of members
    df_bc : pd.DataFrame
        Zero boundary conditions table, for nodes with one or more constrained degrees of freedom
    df_mprop : pd.DataFrame
        Material properties table

    Returns
    -------
    ssm : NDArrayFloat
        Structure stiffness matrix of the structure
    lm : NDArrayInt
        Location matrix, specifying degree of freedom number for each node
    ndof : int
        Number of degrees of freedom of the structure
    """
    n = len(df_xy)
    lm, ndof = pf_calclm(n, df_bc)
    nmem = len(df_conn)
    ssm = np.zeros((ndof, ndof), dtype=float)
    for imem in range(1, nmem + 1):
        ssm = pf_assemssm(imem, df_xy, df_conn, df_mprop, lm, ssm)
    return ssm, lm, ndof</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="msa.pf.pf_stiff" class="doc doc-heading">
            <code class="highlight language-python">pf_stiff(E, A, Iz, L)</code>

<a href="#msa.pf.pf_stiff" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Calculate stiffness of a plane frame member in local coordinate system</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>E</code></b>
                  (<code><span title="float">float</span></code>)
              –
              <div class="doc-md-description">
                <p>Modulus of elasticity of material of the member</p>
              </div>
            </li>
            <li>
              <b><code>A</code></b>
                  (<code><span title="float">float</span></code>)
              –
              <div class="doc-md-description">
                <p>Cross-section area of the member</p>
              </div>
            </li>
            <li>
              <b><code>Iz</code></b>
                  (<code><span title="float">float</span></code>)
              –
              <div class="doc-md-description">
                <p>Second moment of area of the member about the axis of bending</p>
              </div>
            </li>
            <li>
              <b><code>L</code></b>
                  (<code><span title="float">float</span></code>)
              –
              <div class="doc-md-description">
                <p>Length of the member</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="msa.pf.NDArrayFloat">NDArrayFloat</span></code>
              –
              <div class="doc-md-description">
                <p>Stiffness matrix of member about local axes</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>msa/pf.py</code></summary>
              <pre class="highlight"><code class="language-python">def pf_stiff(E: float, A: float, Iz: float, L: float) -&gt; NDArrayFloat:
    """Calculate stiffness of a plane frame member in local coordinate system

    Parameters
    ----------
    E : float
        Modulus of elasticity of material of the member
    A : float
        Cross-section area of the member
    Iz : float
        Second moment of area of the member about the axis of bending
    L : float
        Length of the member

    Returns
    -------
    NDArrayFloat
        Stiffness matrix of member about local axes
    """
    k = np.zeros((6, 6), dtype=float)
    k[0, 0] = float(E) * A / L
    k[0, 3] = -k[0, 0]

    k[1, 1] = (12.0 * E * Iz) / L**3
    k[1, 2] = (6.0 * E * Iz) / L**2
    k[1, 4] = -k[1, 1]
    k[1, 5] = k[1, 2]

    k[2, 2] = (4.0 * E * Iz) / L
    k[2, 4] = -k[1, 2]
    k[2, 5] = k[2, 2] / 2.0

    k[3, 3] = k[0, 0]

    k[4, 4] = k[1, 1]
    k[4, 5] = -k[1, 2]

    k[5, 5] = k[2, 2]

    for i in range(6):
        for j in range(i):
            k[i, j] = k[j, i]

    return k</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="msa.pf.print_mat" class="doc doc-heading">
            <code class="highlight language-python">print_mat(header, k)</code>

<a href="#msa.pf.print_mat" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Print the array k, preceded by a header string. Each element of k is
printed using the format string fmt</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>header</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>Header to be printed before printing the matrix</p>
              </div>
            </li>
            <li>
              <b><code>k</code></b>
                  (<code><span title="numpy.typing.NDArray">NDArray</span>[<span title="typing.Any">Any</span>]</code>)
              –
              <div class="doc-md-description">
                <p>Matrix to be printed</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>msa/pf.py</code></summary>
              <pre class="highlight"><code class="language-python">def print_mat(header: str, k: npt.NDArray[Any]) -&gt; None:
    """Print the array k, preceded by a header string. Each element of k is
    printed using the format string fmt

    Parameters
    ----------
    header : str
        Header to be printed before printing the matrix
    k : npt.NDArray[Any]
        Matrix to be printed
    """
    m, n = k.shape
    print(f"{header} Size: {m} x {n}")
    for i in range(m):
        for j in range(n):
            print(f"{k[i, j]:12.4f}", end="")
        print()</code></pre>
            </details>
    </div>

</div>



  </div>

    </div>

</div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../usermanual/" class="btn btn-neutral float-left" title="User Manual"><span class="icon icon-circle-arrow-left"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../usermanual/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../javascripts/mathjax.js"></script>
      <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
